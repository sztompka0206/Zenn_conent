---
title: "Pthreadsã‚’ä½¿ç”¨ã—ãŸãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ãƒ—ãƒ­ã‚°ãƒ©ãƒ "
emoji: "ğŸŒµ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [multithread, pthreads]
published: false
---

## Pthreadsã«ã¤ã„ã¦

pthreadã¨ã¯ã€POSIXã‚¹ãƒ¬ãƒƒãƒ‰ã®ã“ã¨ã§ã€POSIXæ¨™æº–ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã™ã€‚pthreadã¯ã€Unixç³»ãªã©ã§ä½¿ã‚ã‚Œã‚‹ãã†ã§ã™ã€‚Cè¨€èªã§ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ã™ã‚‹ã¨ãã«ä½¿ç”¨ã•ã‚Œã‚‹Cãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä½œæˆã™ã‚‹forkã¨ã®é•ã„ã¯ã€ã‚¹ãƒ¬ãƒƒãƒ‰ã¯åŒã˜ãƒ¡ãƒ¢ãƒªç©ºé–“ã§æ®´æ‰“ã™ã‚‹ãŸã‚ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒªã‚½ãƒ¼ã‚¹ãŒå…±æœ‰ã•ã‚Œã‚‹ã“ã¨ã§ã™ã€‚

## æ’ä»–åˆ¶å¾¡

ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã™ã‚‹éš›ã«ã€æœ€ã‚‚æ°—ã‚’ä»˜ã‘ãªã‘ã‚Œã°ã„ã‘ãªã„ã“ã¨ã¯ã€è¤‡æ•°ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§å…±æœ‰ãƒ¡ãƒ¢ãƒª(ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã‚’å«ã‚)ã‚’ä½¿ç”¨ã™ã‚‹éš›ã®æ’ä»–åˆ¶å¾¡å‹•ä½œã§ã™ã€‚ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã‚’æ¸›ã‚‰ã—ãªãŒã‚‰ã€ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ãªé–¢æ•°ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```cpp: primeNumber_thread.cpp
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>


#define MAX_PRIME_NUMBERS 100000

/* ç´ æ•°ã®ä¸€è¦§è¡¨ã€‚nPrimeNumberå€‹ãŒå°ã•ã„é †ç•ªã«å…¥ã£ã¦è¡Œã */
int primeNumber[MAX_PRIME_NUMBERS];
int nPrimeNumber;
/* ç´ æ•°ã‹ã©ã†ã‹ã‚’ç¢ºèªæ¸ˆã¿ã®æœ€å¤§ã®æ•° */
int primeNumberChecked;


/*
 *  mãŒç´ æ•°ã‹ã©ã†ã‹ç¢ºèªã™ã‚‹
 *  m/2ä»¥ä¸‹ã®ç´ æ•°ãŒå…¨ã¦primeNumberãƒ†ãƒ¼ãƒ–ãƒ«ã«å…¥ã£ã¦ã„ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚
 */
int isPrimeNumber(int m) {
    int i;
    for(i = 0; i < nPrimeNumber; i++) {
        if(primeNumber[i] > m/2)
            return 1; /* m/2ã‚ˆã‚Šå¤§ãã„æ•°ã§å‰²ã‚Šåˆ‡ã‚Œã‚‹ã“ã¨ã¯ãªã„ */
        if(m%primeNumber[i] == 0)
            return 0;
    }
    return 1;
}

/*
 *  nä»¥ä¸‹ã®ç´ æ•°ã‚’primeNumberãƒ†ãƒ¼ãƒ–ãƒ«ã«å…¥ã‚Œã‚‹ã€‚
 */
void generatePrimeNumbers(int n) {
    int i;

    if(n <= primeNumberChecked) {
        /* ã™ã§ã«ç´ æ•°ä¸€è¦§ã‚’ä½œæˆæ¸ˆã¿ãªã®ã§ãªã«ã‚‚ã™ã‚‹ã“ã¨ã¯ãªã„ */
        return;
    }
    /* è¶³ã‚Šãªã„åˆ†ã®ç´ æ•°è¡¨ã‚’ä½œæˆã™ã‚‹ */
    for(i = primeNumberChecked+1; i <= n; i++) {
        if(isPrimeNumber(i)) {
            if(nPrimeNumber >= MAX_PRIME_NUMBERS) {
                printf("Oops, too many prime numbers.\n");
                exit(1);
            }
            primeNumber[nPrimeNumber] = i;
            nPrimeNumber++;
            //printf("%d: %d is a prime number\n", nPrimeNumber, i);
        }
    }
    primeNumberChecked = n;
    return;
}

/*
 * nä»¥ä¸‹ã®ç´ æ•°ã®å€‹æ•°ã‚’æ•°ãˆã‚‹
 */
int countPrimeNumbers(int n) {
    int count,i;

    generatePrimeNumbers(n);
    count = 0;
    for(i = 0; i < nPrimeNumber; i++) {
        if(primeNumber[i] > n)
            break;
        count++;
    }
    return count;
}

void *threadFunc(void *arg) {
    int n = (int)arg;
    int x;

    x = countPrimeNumbers(n);
    printf("Number of prime numbers under %d is %d\n", n, x);

    return NULL;
}

int main() {
    int numberList[6] = {1,10,100,1000,10000,100000};
    pthread_t threads[6];
    int i;

    nPrimeNumber = 0;
    primeNumberChecked = 1;

    for(i = 0; i < 6; i++) {
        if(pthread_create(&threads[i], NULL, threadFunc, (void *)numberList[i]) != 0) {
            printf("Can't create thread (%d)\n", i);
            exit(1);
        }
    }

    for(i = 0; i < 6; i++) {
        pthread_join(threads[i], NULL);
    }

    printf("Done\n");

    return 0;
}

```

## è¦‹å‡ºã—3

- Hello!
- Hola!
  - Bonjour!
  - Hi!

1. First
2. Second

[ã‚¢ãƒ³ã‚«ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆ](ãƒªãƒ³ã‚¯ã®URL)

![altãƒ†ã‚­ã‚¹ãƒˆ](https://previews.123rf.com/images/jiawangkun/jiawangkun1712/jiawangkun171200059/92222234-%E7%B1%B3%E5%9B%BD%E3%83%95%E3%83%AD%E3%83%AA%E3%83%80%E5%B7%9E%E3%82%B1%E3%83%BC%E3%83%97%E3%82%AB%E3%83%8A%E3%83%99%E3%83%A9%E3%83%AB%E3%81%AB%E3%81%82%E3%82%8B%E3%82%B1%E3%83%8D%E3%83%87%E3%82%A3%E5%AE%87%E5%AE%99%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC%E3%83%93%E3%82%B8%E3%82%BF%E3%83%BC%E3%82%B3%E3%83%B3%E3%83%97%E3%83%AC%E3%83%83%E3%82%AF%E3%82%B9%E3%80%81%E3%82%A2%E3%83%9D%E3%83%AD%E3%82%B5%E3%82%BF%E3%83%BC%E3%83%B3v%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%AB%E5%B1%95%E7%A4%BA%E3%81%95%E3%82%8C%E3%81%9F%E3%82%B5%E3%82%BF%E3%83%BC%E3%83%B3v%E3%83%AD%E3%82%B1%E3%83%83%E3%83%88%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3%E3%80%82.jpg?fj=1)
*ã‚µã‚¿ãƒ¼ãƒ³Vãƒ­ã‚±ãƒƒãƒˆã®ä¸€æ®µç›®ã‚¨ãƒ³ã‚¸ãƒ³*

| Head | Head | Head |
| ---- | ---- | ---- |
| Text | Text | Text |
| Text | Text | Text |

```cpp:main.cpp
#include<iostream>
using namespace std;

int main(){
    cout << "Hello World!" << endl;
    return 0;
}
```

:::details å‡ºåŠ›
Hello World!
:::

```diff cpp:diff.cpp
#include<iostream>
using namespace std;

int main(){
+   cout << "Hello World!!!" << endl;
-   cout << "Hello World!" << endl;
    return 0;
}
```

$$
e^{i\theta} = \cos\theta + i\sin\theta
$$

> å¼•ç”¨æ–‡
> å¼•ç”¨æ–‡

è„šæ³¨ã®ä¾‹[^1]ã§ã™ã€‚ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³^[è„šæ³¨ã®å†…å®¹ãã®2]ã§æ›¸ãã“ã¨ã‚‚ã§ãã¾ã™ã€‚

[^1]: ã€ŒLinuxã¨pthreadsã«ã‚ˆã‚‹ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å…¥é–€ã€, æ¸‹è°·å…‹æ™º

-----

*ã‚¤ã‚¿ãƒªãƒƒã‚¯*
**å¤ªå­—**
~~æ‰“ã¡æ¶ˆã—ç·š~~
ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§`code`ã‚’æŒ¿å…¥ã™ã‚‹

:::message
ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã“ã“ã«
:::

:::message alert
è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã“ã“ã«
:::

:::details ã‚¿ã‚¤ãƒˆãƒ«
è¡¨ç¤ºã—ãŸã„å†…å®¹
:::

::::details ã‚¿ã‚¤ãƒˆãƒ«
:::message
ãƒã‚¹ãƒˆã•ã‚ŒãŸè¦ç´ 
:::
::::


https://zenn.dev/zenn/articles/markdown-guide

```mermaid
graph TB
    A[Hard edge] -->|Link text| B(Round edge)
    B --> C{Decision}
    C -->|One| D[Result one]
    C -->|Two| E[Result two]
```

```mermaid
graph LR
   a --> b & c--> d
```
